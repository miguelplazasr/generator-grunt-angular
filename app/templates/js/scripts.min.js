"use strict";var app=angular.module("veedorApp",["ngMaterial","ngMdIcons","ngRoute","ngResource"]);app.config(function(a){a.when("/",{controller:"MainCtrl"}).when("/category",{controller:"CategoryCtrl",templateUrl:"tpl/category/categories_index.html"}).when("/category/new",{controller:"CategoryCtrl",templateUrl:"tpl/category/categories_new.html"}).when("/category/show/:categoryId",{controller:"CategoryShowCtrl",templateUrl:"tpl/category/categories_show.html"}).when("/issue",{controller:"IssueCtrl",templateUrl:"tpl/issue/issue_index.html"}).when("/issue/new",{controller:"IssueCtrl",templateUrl:"tpl/issue/issue_new.html"}).otherwise({redirectTo:"/"})}),app.config(function(a){a.theme("default").primaryPalette("indigo",{"default":"800"}).accentPalette("amber",{"default":"500"})});var domain="http://localhost:8000";app.factory("Category",function(a){var b=domain+"/api/categories/",c=a(b+":id",{id:"@id",category:"@category"},{all:{method:"get",isArray:!0},save:{method:"POST",transformRequest:function(a,b){return b=angular.extend({},b,{"Content-Type":"application/json"}),angular.toJson(a)}},"new":{method:"GET",url:b+"new.json"},"delete":{method:"DELETE",params:{id:"@id"}},get:{method:"GET",params:{id:"@id"}},update:{method:"PUT",params:{id:"@id"},isArray:!1,transformRequest:function(a,b){return b=angular.extend({},b,{"Content-Type":"application/json"}),angular.toJson(a)}}});return c}),app.factory("Issue",function(a){var b=domain+"/api/issues/",c=a(b+":id",{id:"@id"},{all:{method:"get",isArray:!0},save:{method:"POST",transformRequest:function(a,b){return b=angular.extend({},b,{"Content-Type":"application/json"}),angular.toJson(a)}},"new":{method:"GET",url:b+"new.json"},"delete":{method:"DELETE",params:{id:"@id"}},update:{method:"PUT",params:{id:"@id"},isArray:!1,transformRequest:function(a,b){return b=angular.extend({},b,{"Content-Type":"application/json"}),angular.toJson(a)}}});return c}),app.factory("IssueByCategory",function(a){var b=domain+"/api/issues/:category/category",c=a(b,{category:"@category"},{get:{method:"GET",params:{category:"@category"}}});return c}),app.controller("CategoryCtrl",function(a,b,c,d,e,f){function g(){f.all(function(b){a.categories=b})}function h(a,b,c){a.category=c,a.hide=function(){b.hide()},a.cancel=function(){b.cancel()},a.answer=function(a){b.hide(a)},a.saveCategory=function(a){var c=new f({category:a});c.$save(function(a,c){g(),b.hide(),e.show(e.simple().textContent("Category was created!"))})},a.updateCategory=function(a){var c=new f(a);c.$update({id:a.category.id},a),b.hide(),e.show(e.simple().textContent("Category was updated!"))}}function i(b){for(var c=0,d=a.categories.length;d>c;c++)if(a.categories[c].id===b){f["delete"]({id:b}),a.categories.splice(c,1),e.show(e.simple().textContent("Category was deleted!"));break}}a.title="Categorias",a.categories=f.all(),a.rsCategory={},a.goToCategory=function(a,b){console.log(a),d.path("/category/show/").search({categoryId:a}),console.log(d.path())},a.showDelete=function(a,c){var d=b.confirm().title("ADVERTENCIA!").textContent('Desea eliminar la categoría "'+a.name+'"?').ariaLabel("Eliminar categoría").targetEvent(c).ok("Cancel").cancel("Ok");b.show(d).then(function(){console.log("Cancel delete")},function(){i(a.id)})},a.showAdd=function(a){b.show({controller:h,templateUrl:"tpl/categories_new.html",parent:angular.element(document.body),targetEvent:a,clickOutsideToClose:!0,locals:{category:null}})},a.editCategory=function(a,c){b.show({controller:h,templateUrl:"tpl/categories_edit.html",parent:angular.element(document.body),targetEvent:c,clickOutsideToClose:!0,locals:{category:a}})},a.fields=f["new"]()}),app.controller("CategoryShowCtrl",function(a,b,c,d,e){c("IssueCtrl",{$scope:a});var f=d.get({id:b.categoryId},function(b){a.category=b});a.issueCat=e.get({category:b.categoryId}),a.title=f.name}),app.controller("IssueCtrl",function(a,b){a.title="Issues",a.issues=b.all()}),app.controller("MainCtrl",["$scope","$mdBottomSheet","$mdSidenav","$mdDialog",function(a,b,c,d){a.toggleSidenav=function(a){c(a).toggle()},a.menu=[{link:"/#/category",title:"Categories",icon:"dashboard"}]}]);